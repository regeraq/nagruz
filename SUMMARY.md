# üìä –ö—Ä–∞—Ç–∫–æ–µ –†–µ–∑—é–º–µ –ê–Ω–∞–ª–∏–∑–∞ –∏ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

## üîç –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ü—Ä–æ–±–ª–µ–º—ã

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (–ö—Ä–∏—Ç–∏—á–Ω–æ)
1. ‚úÖ **XSS —É—è–∑–≤–∏–º–æ—Å—Ç–∏** - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥ –≤—Å—Ç–∞–≤–ª—è–ª—Å—è –≤ HTML –±–µ–∑ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
2. ‚úÖ **–£—Ç–µ—á–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏** - Stack trace –æ—Ç–ø—Ä–∞–≤–ª—è–ª—Å—è –∫–ª–∏–µ–Ω—Ç—É –≤ production
3. ‚úÖ **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ rate limiting** - –í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —É—è–∑–≤–∏–º—ã –¥–ª—è DDoS
4. ‚úÖ **–ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö** - –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
1. ‚úÖ **–ù–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è** - –ö—É—Ä—Å—ã –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç –∑–∞–ø—Ä–∞—à–∏–≤–∞–ª–∏—Å—å –∫–∞–∂–¥—ã–π —Ä–∞–∑
2. ‚úÖ **–ù–µ—Ç —Ç–∞–π–º–∞—É—Ç–æ–≤** - –í–Ω–µ—à–Ω–∏–µ API –º–æ–≥–ª–∏ –∑–∞–≤–∏—Å–Ω—É—Ç—å
3. ‚úÖ **–ù–µ—Ç–æ—á–Ω—ã–π —Ä–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞** - –ú–æ–≥ –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø—Ä–æ–±–ª–µ–º–∞–º

### –õ–æ–≥–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏
1. ‚úÖ **–ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞** - 1.5 —Å–µ–∫—É–Ω–¥—ã –±–µ–∑ –ø—Ä–∏—á–∏–Ω—ã –≤ payment-modal
2. ‚úÖ **–ü—Ä–æ–±–ª–µ–º—ã —Å timezone** - –†–µ–∑–µ—Ä–≤–∞—Ü–∏—è –∑–∞–∫–∞–∑–∞ –±–µ–∑ —É—á–µ—Ç–∞ —á–∞—Å–æ–≤–æ–≥–æ –ø–æ—è—Å–∞
3. ‚úÖ **–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —É—Ç–µ—á–∫–∞ –ø–∞–º—è—Ç–∏** - Event listeners –º–æ–≥–ª–∏ –Ω–µ —É–¥–∞–ª—è—Ç—å—Å—è

## üõ†Ô∏è –í–Ω–µ—Å–µ–Ω–Ω—ã–µ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã
1. **`server/security.ts`** - –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
   - `escapeHtml()` - –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ HTML
   - `sanitizeInput()` - –û—á–∏—Å—Ç–∫–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
   - `calculateBase64Size()` - –¢–æ—á–Ω—ã–π —Ä–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞
   - –í–∞–ª–∏–¥–∞—Ü–∏—è email, —Ç–µ–ª–µ—Ñ–æ–Ω–∞, —Ñ–∞–π–ª–æ–≤

2. **`server/rateLimiter.ts`** - Rate limiting middleware
   - In-memory —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
   - –ì–æ—Ç–æ–≤–æ –∫ –ø–µ—Ä–µ—Ö–æ–¥—É –Ω–∞ Redis
   - –†–∞–∑–Ω—ã–µ –ª–∏–º–∏—Ç—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤

3. **`server/cache.ts`** - –°–∏—Å—Ç–µ–º–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
   - In-memory –∫—ç—à —Å TTL
   - –ì–æ—Ç–æ–≤–æ –∫ –ø–µ—Ä–µ—Ö–æ–¥—É –Ω–∞ Redis
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –∏—Å—Ç–µ–∫—à–∏—Ö –∑–∞–ø–∏—Å–µ–π

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

#### `server/index.FIXED.ts`
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (–Ω–µ—Ç —É—Ç–µ—á–∫–∏ stack trace)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã security headers
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ CORS
- ‚úÖ –£–º–µ–Ω—å—à–µ–Ω –ª–∏–º–∏—Ç —Ä–∞–∑–º–µ—Ä–∞ —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞ (1mb –≤–º–µ—Å—Ç–æ 30mb)
- ‚úÖ –£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

#### `server/routes.FIXED.ts`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω rate limiting –Ω–∞ –≤—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã XSS —É—è–∑–≤–∏–º–æ—Å—Ç–∏ (—ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ HTML)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∫—É—Ä—Å–æ–≤ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç (30 —Å–µ–∫)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ (5 –º–∏–Ω)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã —Ç–∞–π–º–∞—É—Ç—ã –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö API (10 —Å–µ–∫)
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω —Ä–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ email (–Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç)

## üìà –£–ª—É—á—à–µ–Ω–∏—è –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|-----|-------|-----------|
| –ó–∞–ø—Ä–æ—Å—ã –∫ CoinGecko API | –ö–∞–∂–¥—ã–π —Ä–∞–∑ | –†–∞–∑ –≤ 30 —Å–µ–∫ | ~99% —Å–Ω–∏–∂–µ–Ω–∏–µ |
| –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ /api/crypto-rates | ~500-2000ms | ~1-5ms (–∫—ç—à) | ~100-2000x |
| –ó–∞—â–∏—Ç–∞ –æ—Ç DDoS | –ù–µ—Ç | Rate limiting | ‚úÖ |
| –£—Ç–µ—á–∫–∞ –ø–∞–º—è—Ç–∏ | –í–æ–∑–º–æ–∂–Ω–∞ | –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ | ‚úÖ |

## üîí –£–ª—É—á—à–µ–Ω–∏—è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

| –£—è–∑–≤–∏–º–æ—Å—Ç—å | –°—Ç–∞—Ç—É—Å | –†–µ—à–µ–Ω–∏–µ |
|------------|--------|---------|
| XSS –≤ email | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ | `escapeHtml()` |
| –£—Ç–µ—á–∫–∞ stack trace | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ | –£—Å–ª–æ–≤–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ |
| DDoS –∞—Ç–∞–∫–∏ | ‚úÖ –ó–∞—â–∏—â–µ–Ω–æ | Rate limiting |
| –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ | –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö |
| –ë–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã | ‚úÖ –ó–∞—â–∏—â–µ–Ω–æ | –¢–æ—á–Ω—ã–π —Ä–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ |

## üéØ Rate Limiting –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

| –≠–Ω–¥–ø–æ–∏–Ω—Ç | –õ–∏–º–∏—Ç | –û–∫–Ω–æ | –ü—Ä–∏—á–∏–Ω–∞ |
|----------|-------|------|---------|
| POST /api/contact | 5 | 1 –º–∏–Ω | –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞ |
| POST /api/orders | 10 | 1 –º–∏–Ω | –ó–∞—â–∏—Ç–∞ –æ—Ç —Ñ–ª—É–¥–∞ –∑–∞–∫–∞–∑–æ–≤ |
| POST /api/promo/validate | 20 | 1 –º–∏–Ω | –ó–∞—â–∏—Ç–∞ –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞ |
| GET /api/crypto-rates | 60 | 1 –º–∏–Ω | –°–Ω–∏–∂–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏ |
| GET /api/* | 100 | 1 –º–∏–Ω | –û–±—â–∏–π –ª–∏–º–∏—Ç |

## üì¶ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

| –†–µ—Å—É—Ä—Å | TTL | –≠–∫–æ–Ω–æ–º–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ |
|--------|-----|-------------------|
| –ö—É—Ä—Å—ã –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç | 30 —Å–µ–∫ | ~99% |
| –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ | 5 –º–∏–Ω | ~99% |
| –ü—Ä–æ–º–æ–∫–æ–¥—ã | 1 –º–∏–Ω | ~95% |

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ –®–∞–≥–∏ (–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏)

### –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
1. –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ Redis –¥–ª—è rate limiting –∏ –∫—ç—à–∞
2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ HTTPS
3. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ Helmet middleware
4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ CORS –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤

### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
1. –ü–µ—Ä–µ—Ö–æ–¥ —Å MemStorage –Ω–∞ PostgreSQL
2. –û—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á –¥–ª—è email (Bull/BullMQ)
3. –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (Winston/Pino)
4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏ (Prometheus)

### –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
1. –ü–∞–≥–∏–Ω–∞—Ü–∏—è –¥–ª—è —Å–ø–∏—Å–∫–æ–≤
2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î
3. CDN –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤
4. Service Worker –¥–ª—è –æ—Ñ–ª–∞–π–Ω —Ä–∞–±–æ—Ç—ã

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã
- In-memory —Ä–µ—à–µ–Ω–∏—è –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ Redis –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è API
- –ö–æ–¥ –≥–æ—Ç–æ–≤ –∫ production –ø–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Redis –∏ HTTPS
- –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –í–Ω–µ–¥—Ä–µ–Ω–∏—è

- [ ] –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã (security.ts, rateLimiter.ts, cache.ts)
- [ ] –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–∑ .FIXED —Ñ–∞–π–ª–æ–≤
- [ ] –£–±—Ä–∞—Ç—å –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—É—é –∑–∞–¥–µ—Ä–∂–∫—É –≤ payment-modal.tsx
- [ ] –ò—Å–ø—Ä–∞–≤–∏—Ç—å event listener –≤ home.tsx
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å rate limiting
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å XSS –∑–∞—â–∏—Ç—É
- [ ] (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Redis
- [ ] (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ù–∞—Å—Ç—Ä–æ–∏—Ç—å HTTPS


